Function: subcycloiwasawa
Section: number_fields
C-Name: subcycloiwasawa
Prototype: GGD0,L,
Help: subcycloiwasawa(fH, p, {n=0}): Let F be the abelian
 number field contained in Q(zeta_f) corresponding to the subgroup H of
 (Z/fZ)^*. Returns the minus part of Iwasawa polynomials attached to the
 cyclotomic Z_p extension of F.
Doc: Let $F$ be the abelian number field contained in $\Q(\zeta_{f})$
 corresponding to the subgroup $H$ of $(\Z/f\Z)^{*}$, let $p > 2$ be an odd
 prime not dividing $[F:\Q]$, let $F_{\infty}$ be the cyclotomic
 $\Z_{p}$-extension of $F$ and let $F_{n}$ by its $n$-th layer.
 Computes the minus part of Iwasawa polynomials and
 $\lambda$-invariants attached to $F_{\infty}$, using the Stickelberger
 elements $\xi_{n}^{\chi}$ belonging to $F_{n}$.

 The function is only implemented when $p$ and $f$ are relatively small: both
 $p^{4}$ and $f$ must fit into an \kbd{unsigned long} integer. The argument
 \kbd{fH} encodes the data $[f,H]$ as follows:

 \item $\kbd{fH} = [f, H]$, where $H$ is given by a vector of
 integral generators,

 \item $\kbd{fH} = [\var{bnr}, H]$, where \var{bnr} is attached to
 $\Cl_{f}(\Q)$ and $H$ is a congruence subgroup,

 \item $\kbd{fH} = [G, H]$, where $G$ is \kbd{idealstar}$(f,1)$, and $H$ is
 a subgroup of $(\Z/f\Z)^{\times}$,

 \item $\kbd{fH} = f$, where we assume that $H = \{1\}$, i.e., $F =
 \Q(\zeta_{f})$,

 \item an irreducible integral polynomial defining a primitive element for $F$.

 \noindent If $F$ is quadratic, we also allow $p = 2$ and more data is
 output (see below).

 For a number field $K$, we write $K_{n}$ for the $n$-th layer of the
 cyclotomic $\Z_{p}$-extension of $K$. The algorithm considers all cyclic
 subfields $K$ of $F$ and all injective odd characters
 $\chi:\text{Gal}(K/\Q)\rightarrow\overline{\Q}_{p}^{\times}$. Let
 $\Sigma_{n} =
 \text{Gal}(K_{n}/K)$, which is cyclic generated by the Frobenius automorphism
 $\sigma$; we write $K_{\chi}=\Q_{p}(\chi)$,
 ${\cal O}_{\chi}=\Z_{p}[\chi]$ with maximal ideal $\goth{p}$.
 The Stickelberger element
 $\xi_{n}^{\chi}$ belongs to ${\cal O}_{\chi}[\Sigma_{n}]$;
 the polynomial $f_{n}^{\chi}(x)\in{\cal O}_{\chi}[x]$
 is constructed from $\xi_{n}^{\chi}$ by the correspondence
 $\sigma \mapsto 1+x$. If $n$ is sufficiently large, then
 $\goth{p}$ does not divide $f_{n}^{\chi}(x)$ and the distinguished polynomial
 $g_{n}^{\chi}(x)\in{\cal O}_{\chi}[x]$ is uniquely determined by the relation
 $f_{n}^{\chi}(x)=u(x)g_{n}^{\chi}(x),\,u(x)\in{\cal O}_{\chi}[x]^{\times}$.
 Owing to Iwasawa Main Conjecture proved by Mazur-Wiles, we can define
 the Iwasawa polynomial
 $g_{\chi}(x)=\lim_{n\rightarrow\infty}g_{n}^{\chi}(x)\in{\cal O}_{\chi}[x]$.
 If $r$ is the smallest integer satisfying
 $\deg g_{n}^{\chi}\leq p^{r}$, then we have
 $$g_{\chi}(x)\equiv g_{n}^{\chi}(x)\pmod{\goth{p}^{n+1-r}}\;.$$
 Applying the norm from $K_{\chi}$ down to $\Q_{p}$, we obtain polynomials
 $G_{\chi}(x), G_{n}^{\chi}(x)\in\Z_{p}[x]$ satisfying the congruence
 $$G_{\chi}(x)\equiv G_{n}^{\chi}(x)\pmod{p^{n+1-r}}\;.$$
 Note that $\lambda_{p}^{-}(F)=\sum_{K,\chi} \deg G_{\chi}(x)$ is the Iwasawa
 $\lambda^{-}$-invariant of $F$, while the $\mu$-invariant $\mu_{p}(F)$ is
 known to be zero by the theorem of Ferrero-Washington.

 If $n = 0$, the function returns $[\lambda_{p}^{-}(F)]$ (the vector may contain
 further useful components, see below); for positive $n$, it returns
 all non-constant $G_{n}^{\chi}(x)\bmod{p^{n+1-r}}$ as $(K,\chi)$ vary.

 \bprog
 ? subcycloiwasawa(22220, 41)  \\ f = 22220, H = {1}
 %1 = [217]
 ? P = polcompositum(x^2 - 42853, polcyclo(5))[1];
 ? subcycloiwasawa(P, 5)
 %3 = [3]
 ? subcycloiwasawa(P, 5, 4) \\ the sum of the degrees is indeed 3
 %4 = [T + 585, T^2 + 405*T]
 @eprog
 The first example corresponds to $F = \Q(\zeta_{22220})$ and shows, that
 $\lambda_{41}^{-}(F) = 217$. The second one builds $F=\Q(\sqrt{42853},
 \zeta_{5})$ then lists the non-constant $G_{4}^{\chi}(x)\bmod{p^{4}}$
 for $p=5$.
 Note that in this case all degrees are $\leq 5$ hence $r \leq 1$ and
 $n+1-r\geq n$; so the above also gives $G_{\chi}$ modulo $p^{4}$.

 We henceforth restrict to the quadratic case, where more information is
 available, and $p = 2$ is now allowed: we write $F = \Q(\sqrt{d})$
 of discriminant $d$ ($\neq 1$) and character $\chi$.

 \misctitle{Algorithm and output for $n = 0$, $F = \Q(\sqrt{d})$}
 Currently, only the case $d < 0$ ($F$ quadratic imaginary,
 i.e.~$\chi(-1)=-1$) is implemented.

 \item If $p > 2$, the function returns
 $[\lambda, \kappa, [e_{0},\dots,e_{k}]]$, where $\lambda=\lambda_{p}^{-}(F)$,
 $p^{e_{n}}$ denotes the $p$-part of the class number of $F_{n}$ and $e_{n} =
 \lambda n + \kappa$ for all $n > k$. We use Gold's theorem
 (Acta Arith. vol.26 (1974), pp.~21--32, vol.26 (1975), pp.~233--240).
 Then as soon as $e_{n} - e_{n-1} < \varphi(p^{n})$ for some $n \geq 1$, we have
 $\lambda_{p}(F)=e_{n}-e_{n-1}$;
 if $\chi(p)=1$ we can weaken the hypothesis to $e_{n}-e_{n-1}\leq
 \varphi(p^{n})$ for some $n\geq 1$ and obtain the same conclusion.
 To compute $e_{n} - e_{n-1}$ we use Bernoulli numbers
 (\kbd{subcyclohminus}) if
 $\chi(p) = 0$ and a much faster algorithm of Gold
 (Pacific J. Math. vol.40 (1972), pp.83--88) otherwise.

 \item For $p=2$, we use Kida's formula (Tohoku Math. J. vol. 31 (1979),
 pp.~91--96) and only return $[\lambda^{-}]$.

 When $d > 1$, \kbd{subcycloiwasawa} should calculate
 $\lambda_{p}(F)=\lambda_{p}^{+}(F)$, which is conjectured to be zero.
 But this is not yet implemented.

 \bprog
 ? subcycloiwasawa(x^2+11111, 2)
 %1 = [5]  /*@Ccom $\lambda_{2}(\Q(\sqrt{-11111}))=5$ */
 ? subcycloiwasawa(x^2+11111, 3)
 %2 = [1, 0, []]
 ? subcycloiwasawa(x^2+11111, 11)
 %3 = [0, 0, []]
 @eprog\noindent This shows that for $p = 3$, we have $\lambda = 1$,
 $\kappa = 0$, and $e_{n} = n$ for all $n \geq 0$.
 And at $p = 11$, we have $e_{n} = 0$ for all $n \geq 0$.

 \bprog
 ? subcycloiwasawa(x^2+1501391, 3)
 time = 23 ms.
 %4 = [14, -16, [2, 5]]
 @eprog\noindent
 computes $e_{n}$ by Gold's algorithm for $F=\Q(\sqrt{-1501391})$.
 This shows that at $p = 3$, we have $\lambda=14$, $\kappa=-16$, then
 $e_{0}=2$, $e_{1}=5$, and $e_{n}=14n-16$ for $n\geq 2$.
 \bprog
 ? subcycloiwasawa(x^2+956238, 3)
 time = 141 ms.
 %5 = [14, -19, [1, 3]]
 @eprog\noindent
 computes $e_{n}$ using Bernoulli numbers for $F=\Q(\sqrt{-956238})$.
 This shows that $e_{0}=1$, $e_{1}=3$ and $e_{n}=14n-19$ for $n \geq 2$.

 \misctitle{Algorithm and output for $n > 0$; $F = \Q(\sqrt{d})$}

 \item When $d < 0$ and $n\geq 1$,
 \kbd{subcycloiwasawa} computes the Stickelberger element
 $\xi_{n} = \xi_{n}^{\chi}\in\Z_{p}[\Sigma_{n}]$ and the Iwasawa polynomial
 $g(x) = g_{\chi}(x)\in\Z_{p}[x]$
 from the $n$-th layer $F_{n}$ of the cyclotomic $\Z_{p}$-extension of $F$.
 Let $q$ be $p$ ($p$ odd) or 4 ($p = 2$) and let
 $q_{0}$ be the lcm of $q$ and the discriminant $d$ of $F$, and let
 $q_{n}=q_{0}p^{n}$.
 Then $\Sigma_{n}=\text{Gal}(\Q_{n}/\Q)=\text{Gal}(F_{n}/F)
 =\langle\,s\,\rangle$,
 where $s$ is the Frobenius automorphism $(\Q_{n}/\Q,1+q_{0})$ and
 $$\xi_{n}=q_{n}^{-1}\sum_{a=1, (a,q_{n})=1}^{q_{n}}
   a\chi(a)^{-1}(\Q_{n}/\Q,a)^{-1}$$
 is an element of $\Q[\Sigma_{n}]$.
 For $(p,d)=(2,-1),(2,-2),(2,-3), (2,-6),(3,-3)$,
 we know that $\lambda_{p}(F)=0$ and there is nothing to do.
 For the other cases, it is proved that $(1/2)\xi_{n}\in\Z_{p}[\Sigma_{n}]$.
 The polynomial $f_{n}(x)\in\Z_{p}[x]$ is constructed from $(1/2)\xi_{n}$
 by the
 correspondence $s\mapsto 1+x$. If $n$ is sufficiently large, then
 $p$ does not divide $f_{n}(x)$ and the distinguished polynomial
 $g_{n}(x)\in\Z_{p}[x]$ is uniquely determined by the relation
 $f_{n}(x)=u(x)g_{n}(x)$, $u(x)\in\Z_{p}[[x]]^{\times}$. The Iwasawa polynomial
 $g(x)$ is defined by $g(x)=\lim_{n\rightarrow\infty}g_{n}(x)$; if $r$ is the
 smallest integer satisfying $\deg g=\lambda_{p}(F)\leq p^{r}$, then we have
 $g(x)\equiv g_{n}(x)\pmod{\,p^{n+1-r}}$ when $p>2$ and modulo $2^{n-r}$
 otherwise.

 \noindent Conjecturally, we have further

 1. case $q_{0}=p$: $\xi_{n}\in\Z[\Sigma_{n}]$.

 2. case $d=-1$ and $\chi(p)=-1$: $\xi_{n}\in\Z[\Sigma_{n}]$.

 3. case $d=-3$ and $\chi(p)=-1$: $(3/2)\xi_{n}\in\Z[\Sigma_{n}]$.

 4. other cases: $(1/2)\xi_{n}\in\Z[\Sigma_{n}]$.

 \noindent Finally, \kbd{subcycloiwasawa} outputs $[g]$ where
 $g$ is $g_{n}(x)\bmod{p^{n+1-r}}$ ($p$ odd) or $\bmod{2^{n-r}}$ ($p = 2$).

 \bprog
 ? subcycloiwasawa(x^2+239, 3, 10)
 %6 = [x^6 + 18780*x^5 + 14526*x^4 + 18168*x^3 + 3951*x^2 + 1128*x]
 @eprog\noindent This is $g(x)\bmod{3^{9}}$. Indeed, $n = 10$,
 $\lambda = 6$ (the degree), hence $r = 2$ and $n + 1 - r = 2$.

 \item When $d > 1$ and $n\geq 1$, $\xi_{n}^{*}\in\Q[\Sigma_{n}]$ is
 constructed from
 $\chi^{*}=\chi^{-1}\omega$, where $\chi$ is the character of
 $F=\Q(\sqrt{d}\,)$
 and $\omega$ is the Teichm\"uller character $\bmod{\,q}$. Next we construct
 $f_{n}^{*}(x)\in\Z_{p}[x]$ from $(1/2)\xi_{n}^{*}$ by the correspondence
 $s^{-1}\mapsto (1+x)(1+q_{0})^{-1}$ and define the distinguished
 polynomial $g_{n}^{*}(x)\in\Z_{p}[x]$ using $f_{n}^{*}(x)$.
 Then $g^{*}(x)=\lim_{n\rightarrow\infty}g_{n}^{*}(x)$ is the Iwasawa
 polynomial, which has a connection with Greenberg conjecture for $F$.
 Let $r$ be the smallest integer satisfying $\deg g^{*}\leq p^{r}$,
 then we have $g^{*}(x)\equiv g_{n}^{*}(x)\pmod{\,p^{n+1-r}}$
 when $p>2$ and $g^{*}(x)\equiv g_{n}^{*}(x)\pmod{\,2^{n-r}}$ when $p=2$.
 Finally, \kbd{subcycloiwasawa} outputs $[g^{*}]$ where
 $g^{*}$ is $g_{n}^{*}(x)\bmod{p^{n+1-r}}$ ($p$ odd) or $\bmod{2^{n-r}}$ ($p = 2$).

 \bprog
 ? subcycloiwasawa(x^2-13841, 2, 19)
 time = 1min, 17,238 ms.
 %7 = [x^3 + 30644*x^2 + 126772*x + 44128]
 @eprog
 \noindent
 This is $g^{*}(x)\bmod{\,2^{17}}$ ($r = 2$), the distinguished polynomial
 treated in a paper of T. Fukuda, K. Komatsu, M. Ozaki and T. Tsuji
 (Funct. Approx. Comment. Math. vol.54.1, pp.~7--17, 2016).
