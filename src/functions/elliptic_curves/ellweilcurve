Function: ellweilcurve
Section: elliptic_curves
C-Name: ellweilcurve
Prototype: G
Help: ellweilcurve(E): E being an elliptic curve over Q,
 return a list of representatives of the isomorphism classes of elliptic curves
 isogenous to E as given by ellisomat and the list of the Smith invariants of
 the lattice associated to E in H^1(E,Q) in the lattice associated to the
 modular form.
Doc: If $E'$ is an elliptic curve over $\Q$, let $L_{E'}$ be the
 sub-$\Z$-module of $\Hom_{\Gamma_0(N)}(\Delta,\Q)$ attached to $E'$
 (It is given by $x[3]$ if $[M,x] = \kbd{msfromell}(E')$.)

 On the other hand, if $N$ is the conductor of $E$ and $f$ is the modular form
 for $\Gamma_0(N)$ attached to $E$, let $L_f$ be the lattice of
 the $f$-component of
 $\Hom_{\Gamma_0(N)}(\Delta,\Q)$ given by the elements $\phi$ such that
 $\phi(\{0,\gamma^{-1} 0\}) \in \Z$ for all $\gamma \in \Gamma_0(N)$
 (see \tet{mslattice}). Return minimal models for the list of representatives
 of the isomorphism classes of elliptic curves $E'$ isogenous to $E$ given by
 \kbd{ellisomat} and the list of the Smith invariants of the lattices $L_{E'}$
 in $L_f$.

 In particular, the strong Weil curve amongst the curves isogenous to $E$
 is the one whose Smith invariants are $[1,1]$.
 \bprog
 ? E = ellinit("11a3");
 ? [H, smith] = ellweilcurve(E);
 ? [ i | i<-[1..#ind], ind[i]==[1,1] ]  \\ one lattice with invariant [1,1]
 %3 = [2]
 ? ellidentify(H[2]) \\ ... corresponds to strong Weil curve
 %4 = [["11a1", [0, -1, 1, -10, -20], []], [1, 0, 0, 0]]
 @eprog
