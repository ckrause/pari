\\package:elldata
default(realprecision,38);
K=nfinit(t^3-2);
e=ellinit([t+1,t^2 - (t^3+(t+1)*t)], K);
P=[t,t];
ellisoncurve(e, P)
elladd(e, P,P)
ellmul(e, P,3)
ellordinate(e, t)
ellordinate(e, t+1)
elldivpol(e, 3)
ellfromj(Mod(t,t^3-2))
ellinit(e, idealprimedec(K,2)[1])
ellinit(e, idealprimedec(K,5)[1])

{
  K = nfinit(t);
  forell(E, 1, 1000,
    my(e,N,f,v);
    v = [1/60,7131/3600,11/12,5/12];
    e = ellchangecurve(ellinit(E[2],1), v);
    eK= ellchangecurve(ellinit(E[2],K), v);
    N = ellconvertname(E[1])[1];
    f = factor(N)[,1];
    for(i=1, #f,
      my(p = f[i], P,A,B);
      P=idealprimedec(K,p)[1];
      A=elllocalred(e,P.p); A[3]=0;
      B=elllocalred(eK,P); B[3]=0;
      if(A!=B, error(E[2]));
      if(ellap(e,p) != ellap(eK,P),error(E[2]))
    )
  )
}

K=nfinit(a^2+1);
P17 = idealprimedec(K,17)[1];
P13 = idealprimedec(K,13)[1];
P5 = idealprimedec(K,5)[1];
E=ellinit([1+a,0,1,0,0],K);
E2 = ellchangecurve(E, [17,0,0,0]);
[ellap(E2, P5), ellap(E2, P13), ellap(E2, P17)]
[ellcard(E2, P5), ellcard(E2, P13), ellcard(E2, P17)]
E3 = ellchangecurve(E, [1/17,a,a+1,0]);
ellap(E3, P17)
ellan(E2,20)
ellan(E3,20)
ellglobalred(E)
ellglobalred(E2)
ellglobalred(E3)

{ E = ellinit(
  [-1377/256*x^6-6885/32*x^4+729/4*x^3-4131/2*x^2+14013/4*x+5589/4,
   -1863/16*x^6-9315/2*x^4-5589/2*x^3-44712*x^2-53460*x+33534],
  nfinit(x^4+20*x^2+16));
}
ellap(E,idealprimedec(E.nf,2)[1])
ellap(E,idealprimedec(E.nf,3)[1])
ellap(E,idealprimedec(E.nf,5)[1])

K=bnfinit(a^2 - 2*3*5*29);
e = ellinit([a,1], K);
E = ellchangecurve(e, Mod([2^3 * 3 * a, a+123, 17*a+2, 16*a+3], K.pol));
ellintegralmodel(E)[1..5]
ellintegralmodel(E, &v)[1..5]
v
ellminimalmodel(E, &v)[1..5]
v

ellminimalmodel(ellinit([a^4,(a+2)^6], K))

p=2*10^10+89; q=10^10+19;
P=nfbasistoalg(K, bnfisprincipal(K, idealprimedec(K,p)[1])[2]);
Q=nfbasistoalg(K, bnfisprincipal(K, idealprimedec(K,q)[1])[2]);
e = ellinit([P^3*Q^4,P^6*Q^4], K);
ellminimalmodel(e,&v); v
ellglobalred(e)
e = ellinit([P^4*Q^4,P^6*Q^4], K);
ellglobalred(e)

K=bnfinit(a^2-65);
u=Mod(8+a,K.pol);
e = ellinit([1,40*u+1,0,25*u^2,0], K); ellminimalmodel(e)
e = ellinit([1,10*u+1,0,25*u^2,0], K); ellminimalmodel(e)
ellglobalred(e)

E=ellinit([0,-1,0,-15/16*z^2+5/2*z+8,5/16*z^2-9*z+14],nfinit(z^3-4*z^2-32*z+64));
ellglobalred(E)

E=ellinit([-3850829794560*a-15877538149168,-8352767604912215040*a-34439343881478343808],bnfinit(a^2-17));
ellminimalmodel(E,&v)[1..5]
v

\\ #1899
E=ellinit([0,34,0,225,0],bnfinit(a^2-7));
ellminimalmodel(E, &v)[1..5]
v

K = nfinit(a^2 - a + 1);
E = ellinit([1, -1, 0, -3*a, -3*a + 3],K);
/* Same curve, non integral model */
E2 = ellinit([(144*a+9)/-48,(3240*a-2565)/-864],K);
idealnorm(K,ellglobalred(E)[1])
idealnorm(K,ellglobalred(E2)[1])
elltamagawa(E)
elltamagawa(E2)
ellrootno(E)
ellrootno(E2)
elltors(E)
elltors(E2)
ellbsd(E)
ellbsd(E2)
E.omega
E2.omega
E.eta
E2.eta
E.area
E2.area

K = nfinit(a^2 - a - 22);
E = ellinit([0, 0, 1, -1590*a - 8580, 92750*a + 359875],K);
idealnorm(K,ellglobalred(E)[1])
elltamagawa(E)
ellrootno(E)
elltors(E)
ellbsd(E)
ellbsd(ellchangecurve(E,[1/Mod(a,K.pol),0,0,0]))
ellbsd(ellchangecurve(E,[Mod(a,K.pol),0,0,0]))
E.omega
E.eta
E.area

K = nfinit(a^3 - a^2 + 1);
E = ellinit([a + 1, -a^2 - a - 1, a^2 + a, -a^2, -a^2 + 1],K);
idealnorm(K,ellglobalred(E)[1])
elltamagawa(E)
ellrootno(E)
elltors(E)
ellbsd(E)
E.omega
E.eta
E.area

K = nfinit(a^2-a-57);
E = ellinit([a,-a,a,-5692-820*a,-259213-36720*a],K);
ellminimaldisc(E)

K = nfinit(a^2-26);
E = ellinit([a,a-1,a+1,4*a+10,2*a+6],K);
ellminimaldisc(E)

E = ellinit([1,2,3,4,5]);
ellminimaldisc(E)

E=ellinit([0,0,1,-5*a-25,-15*a-49],nfinit(a^2-a-1));
P=[-4*a+3,-a+1];
ellheight(E,P)
ellrootno(E)

E=ellinit([a+1,a-1,a,6*a+2,14*a+34],nfinit(a^2-2));
P=[-3/2*a+1/2,-9/4*a-3/2];
ellheight(E,P)
ellrootno(E)

E=ellinit([0,a+1,0,18*a-27,-55*a+78],nfinit(a^2-2));
P=[2*a-5,-2*a+5];
ellheight(E,P)
ellrootno(E)

E=ellinit([0,a+a^2,0,a^3,(a+1)^2],nfinit(a^2-a-1));
P1=[-a,a+1];
P2=[-a^2,a+1];
ellheight(E,P1)
ellheight(E,P2)
ellrootno(E)

E=ellinit([0,a+a^2,0,a^3,(a+1)^2],nfinit(a^2-a-3));
P1=[-a,a+1];
P2=[-a^2,a+1];
ellheight(E,P1)
ellheight(E,P2)
ellrootno(E)

E=ellinit([0,1,0,a*(1-a),(a+1)^2],nfinit(a^2-a-1));
P1=[-a,a+1];
P2=[a-1,a+1];
ellheight(E,P1)
ellheight(E,P2)
ellrootno(E)

E=ellinit([0,a,1,a+1,0],nfinit(a^2+1));
P=[0,0];
ellheight(E,P)
ellrootno(E)

E=ellinit([1,a+1,0,-2*a-1,1],nfinit(a^2+1));
P=[-2*a,-2*a-1];
ellheight(E,P)
ellrootno(E)

E = ellinit([a+1,-a+1,0,7*a-46,-22*a+118], nfinit(a^2-a+3));
P = [3,-2*a+2];
ellheight(E,P)
ellrootno(E)

E = ellinit([a+1,-1,a,-a^2,0], nfinit(a^3-a^2+1));
P = [0,-a];
ellheight(E,P)
ellrootno(E)
