\\package:galdata nflistdata
default(new_galois_format,1);
default(parisize,"20M");

tst(n,k)=
{
  P = nflist([n,k],'t); V = List();
  for(a=1,20,
    Q = subst(P,t,a);
    if (polisirreducible(Q),
      if (n > 11 || polgalois(Q)[3] == k, listput(~V,Q))));
  if (!#V, error(k));
  #V;
}

L=[1,1,2,5,5,16,7,50,34,45,8,301,9,63,104];
S = vector(15,i,[1..L[i]]);
S[9]=setminus([1..L[9]], [14,15]);
S[11]=setminus([1..L[11]], [2,3,4]);
S[12]=setminus([1..L[12]],[1,2,5,10,11,12,13,14,15,18,19,20,25,26,27,28,29,30,31,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,60,61,63,64,70,71,72,73,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,112,114,115,116,117,118,119,120,121,123,124,125,127,130,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,150,151,152,153,154,155,156,158,159,164,166,167,168,169,170,171,172,173,174,180,184,185,186,187,189,190,192,193,194,195,196,197,198,199,204,205,206,207,208,209,210,211,212,214,215,216,217,219,221,222,223,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,243,244,245,246,247,248,249,250,251,253,254,255,256,257,258,259,260,262,263,264,265,266,267,270,271,272,274,277,280,281,282,284,285,286,287,289,290,291,292,293,294,296]);
S[13]=[5,8,9];
S[14]=[42,55,59,60,61,62,63];
S[15]=[10,28,47,72,85,87,89,90,91,92,93,94,95,96,97,99,100,101,102,103,104];
for(n=1,#S,print1(n,": ");print([tst(n,k) | k<-S[n]]))
